# pgAnalytics Collector Configuration Sample
# Copy to /etc/pganalytics/collector.toml and customize

[collector]
# Unique identifier for this collector
id = "col_001"

# Human-readable name
name = "Production DB Server"

# Hostname to report to backend
hostname = "db-server-01"

# Collection interval in seconds (default: 60)
interval = 60

# Enable/disable debug logging
debug = false

[backend]
# Backend API URL (must use HTTPS in production)
url = "https://api.pganalytics.local"

# Path to client certificate (for mTLS)
tls_cert = "/etc/pganalytics/collector.crt"

# Path to client key (for mTLS)
tls_key = "/etc/pganalytics/collector.key"

# Verify backend's TLS certificate (set to false for self-signed certs in demo)
tls_verify = false

# JWT token (will be obtained during collector registration)
# jwt_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."

# Connection timeout in seconds
connection_timeout = 30

# Request timeout in seconds
request_timeout = 60

[postgres]
# PostgreSQL host
host = "localhost"

# PostgreSQL port
port = 5432

# PostgreSQL user (should have minimal read-only permissions)
user = "pganalytics_monitor"

# PostgreSQL password (preferably use PGPASSWORD environment variable)
password = ""

# List of databases to monitor (empty = all)
databases = ["postgres", "app_database"]

# Connection timeout in seconds
connection_timeout = 10

# Whether to collect statistics
collect_stats = true

# Whether to collect logs
collect_logs = true

[collectors]
# Enable/disable specific collectors
pg_stats = true
sysstat = true
disk_usage = true
pg_log = true

[logging]
# Log level: debug, info, warn, error
level = "info"

# Log file path (empty = stdout)
file = "/var/log/pganalytics/collector.log"

# Maximum log file size in MB
max_size = 100

# Number of backup log files to keep
max_backups = 3

# Maximum age of log files in days
max_age = 7

[metrics]
# Enable compression (gzip)
compression = true

# Enable buffering (accumulate metrics before sending)
buffering = true

# Buffer size in number of metrics
buffer_size = 1000

# Flush buffer after timeout in seconds (even if not full)
buffer_timeout = 60

[tls]
# TLS version minimum (1.3 recommended)
min_version = "1.3"

# Custom CA certificate path (optional)
# ca_cert = "/etc/pganalytics/ca.crt"

[retry]
# Number of retry attempts
max_attempts = 3

# Initial retry backoff in seconds
initial_backoff = 1

# Maximum retry backoff in seconds
max_backoff = 60

# Exponential backoff multiplier
multiplier = 2.0
